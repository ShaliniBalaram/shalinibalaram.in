<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Fat Tail Problem: Why Your Statistical Toolkit Might Be Lying to You</title>
    <meta name="description" content="From non-stationarity frustrations to discovering fat tails - a journey into why most of statistics breaks down when it matters most, and what we can do about it.">
    <meta name="author" content="Dr Shalini B">
    <style>
        :root {
            --color-background: #ffffff;
            --color-foreground: #1a1a1a;
            --color-border: #e5e7eb;
            --color-muted: #f9fafb;
            --color-accent: #e53e3e;
            --max-width: 800px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.7;
            color: var(--color-foreground);
            background: var(--color-background);
            padding: 2rem 1rem;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"><circle cx="10" cy="10" r="8" fill="%23e53e3e" opacity="0.5"/></svg>'), auto;
        }

        .container {
            max-width: var(--max-width);
            margin: 0 auto;
            animation: fadeIn 0.6s ease-in;
        }

        /* Playful Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes wobble {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-5deg); }
            75% { transform: rotate(5deg); }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        @keyframes rainbow {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes jello {
            0%, 100% { transform: skewX(0deg) skewY(0deg); }
            30% { transform: skewX(25deg) skewY(25deg); }
            40% { transform: skewX(-15deg) skewY(-15deg); }
            50% { transform: skewX(15deg) skewY(15deg); }
            65% { transform: skewX(-5deg) skewY(-5deg); }
            75% { transform: skewX(5deg) skewY(5deg); }
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            10%, 30% { transform: scale(1.1); }
            20%, 40% { transform: scale(0.95); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        @keyframes wiggle {
            0%, 100% { transform: rotate(-3deg); }
            50% { transform: rotate(3deg); }
        }

        @keyframes flashBorder {
            0%, 100% { border-color: var(--color-border); }
            50% { border-color: #fbbf24; }
        }

        /* Confetti */
        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #ff6b6b;
            pointer-events: none;
            z-index: 1000;
            animation: confetti-fall 3s ease-out forwards;
        }

        header {
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid var(--color-border);
            animation: slideIn 0.6s ease-out;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 1rem;
            line-height: 1.2;
            color: var(--color-foreground);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        h1:hover {
            animation: jello 0.8s ease;
            color: var(--color-accent);
        }

        h1:active {
            animation: heartbeat 0.6s ease;
        }

        .meta {
            color: #666;
            font-size: 0.95rem;
        }

        .tags {
            margin-top: 1rem;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .tag {
            background: var(--color-muted);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.875rem;
            color: #666;
            border: 1px solid var(--color-border);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .tag:hover {
            transform: translateY(-5px) rotate(-5deg);
            box-shadow: 0 5px 15px rgba(229, 62, 62, 0.3);
            background: linear-gradient(45deg, #ff6b6b, #ee5a6f);
            color: white;
            animation: wiggle 0.5s ease infinite;
        }

        h2 {
            font-size: 2rem;
            font-weight: 700;
            margin: 3rem 0 1rem;
            color: var(--color-foreground);
            cursor: pointer;
        }

        h2:hover {
            animation: bounce 0.6s ease;
        }

        h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 2rem 0 1rem;
            color: var(--color-foreground);
        }

        h4 {
            font-size: 1.25rem;
            font-weight: 600;
            margin: 1.5rem 0 0.75rem;
            color: var(--color-foreground);
        }

        p {
            margin: 1rem 0;
        }

        strong {
            font-weight: 600;
            color: var(--color-foreground);
            position: relative;
            cursor: pointer;
        }

        strong:hover {
            color: var(--color-accent);
            animation: pulse 0.5s ease;
        }

        blockquote {
            margin: 2rem 0;
            padding: 1rem 1.5rem;
            background: var(--color-muted);
            border-left: 4px solid var(--color-accent);
            font-style: italic;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        blockquote:hover {
            transform: translateX(10px) rotate(1deg);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            animation: wobble 0.5s ease;
        }

        ul, ol {
            margin: 1rem 0;
            padding-left: 2rem;
        }

        li {
            margin: 0.5rem 0;
            transition: all 0.2s ease;
        }

        li:hover {
            transform: translateX(5px);
            color: var(--color-accent);
        }

        hr {
            margin: 3rem 0;
            border: none;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--color-accent), transparent);
            animation: shimmer 2s ease-in-out infinite;
        }

        /* Interactive visualization styles */
        #comparison-status {
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 6px;
            background: #fef3c7;
            border: 1px solid #fbbf24;
            color: #92400e;
            transition: all 0.5s ease;
            animation: flashBorder 2s ease-in-out infinite;
        }

        #mediocristan-extremistan-compare,
        #catastrophe-demo,
        #sample-size-calc {
            background: var(--color-background);
            border: 2px solid var(--color-border);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        #mediocristan-extremistan-compare:hover,
        #catastrophe-demo:hover,
        #sample-size-calc:hover {
            box-shadow: 0 10px 30px rgba(229, 62, 62, 0.2);
            transform: translateY(-5px);
        }

        .comparison-controls {
            background: rgba(59, 130, 246, 0.05);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }

        .control-group {
            margin: 1rem 0;
            animation: slideIn 0.4s ease-out;
        }

        .control-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }

        .control-group:hover label {
            color: var(--color-accent);
            animation: bounce 0.5s ease;
        }

        .control-group input[type="range"] {
            width: 100%;
            height: 8px;
            background: linear-gradient(90deg, #ddd, #fbbf24);
            border-radius: 3px;
            outline: none;
            transition: all 0.3s ease;
        }

        .control-group input[type="range"]:hover {
            height: 10px;
            animation: pulse 0.5s ease infinite;
        }

        .control-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 3px 10px rgba(229, 62, 62, 0.5);
            transition: all 0.2s ease;
        }

        .control-group input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.3) rotate(180deg);
            box-shadow: 0 5px 20px rgba(229, 62, 62, 0.8);
            animation: rainbow 2s linear infinite;
        }

        .control-group input[type="range"]::-webkit-slider-thumb:active {
            transform: scale(1.1);
            animation: heartbeat 0.3s ease;
        }

        .stats-display {
            background: white;
            padding: 1rem;
            border-radius: 6px;
            margin-top: 1rem;
            border: 1px solid #e5e7eb;
            animation: fadeIn 0.5s ease;
        }

        .stat-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .stat-item {
            padding: 0.5rem;
            background: #f9fafb;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .stat-item:hover {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
            transform: translateY(-5px) rotate(-2deg);
            box-shadow: 0 8px 20px rgba(251, 191, 36, 0.4);
            animation: wobble 0.5s ease;
        }

        .stat-highlight {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            padding: 1rem;
            border-radius: 6px;
            border-left: 4px solid #f59e0b;
            animation: pulse 2s ease-in-out infinite;
        }

        .stat-highlight:hover {
            animation: jello 0.8s ease, rainbow 3s linear infinite;
        }

        .plot-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }

        .plot-item {
            text-align: center;
            animation: fadeIn 0.6s ease;
        }

        .plot-item:hover {
            animation: float 2s ease-in-out infinite;
        }

        .plot-item canvas {
            border: 2px solid var(--color-border);
            border-radius: 12px;
            background: white;
            max-width: 100%;
            height: auto;
            transition: all 0.3s ease;
            cursor: crosshair;
        }

        .plot-item canvas:hover {
            box-shadow: 0 10px 40px rgba(229, 62, 62, 0.3);
            transform: scale(1.05) rotate(1deg);
            border-color: var(--color-accent);
        }

        .plot-item canvas:active {
            animation: shake 0.5s ease;
        }

        .insights-box {
            background: rgba(239, 68, 68, 0.05);
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid #ef4444;
            margin-top: 2rem;
            animation: slideIn 0.5s ease;
            transition: all 0.3s ease;
        }

        .insights-box:hover {
            transform: scale(1.02);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.2);
            animation: pulse 1s ease;
        }

        .insights-box h4 {
            margin-top: 0;
            color: #991b1b;
        }

        .demo-controls {
            display: flex;
            gap: 2rem;
            margin: 1rem 0;
        }

        .demo-option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            transition: all 0.3s ease;
            background: white;
            border: 2px solid var(--color-border);
        }

        .demo-option:hover {
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            color: white;
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
            animation: bounce 0.5s ease;
        }

        .demo-option input[type="radio"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .demo-option input[type="radio"]:checked + label {
            font-weight: 700;
            color: var(--color-accent);
        }

        .demo-option label {
            font-weight: 600;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .result-display {
            margin: 2rem 0;
            min-height: 200px;
        }

        .result-box {
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid;
            animation: slideIn 0.5s ease;
            transition: all 0.3s ease;
        }

        .result-box:hover {
            transform: scale(1.02);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .result-box.mediocristan {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(96, 165, 250, 0.1));
            border-color: #3b82f6;
        }

        .result-box.mediocristan:hover {
            animation: wobble 0.6s ease;
        }

        .result-box.extremistan {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(252, 165, 165, 0.1));
            border-color: #ef4444;
        }

        .result-box.extremistan:hover {
            animation: shake 0.6s ease;
        }

        .result-box .conclusion {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            font-size: 1.05em;
            animation: fadeIn 0.6s ease;
        }

        #catastrophe-plot {
            display: block;
            margin: 2rem auto;
            border: 2px solid var(--color-border);
            border-radius: 12px;
            background: white;
            max-width: 100%;
            transition: all 0.3s ease;
        }

        #catastrophe-plot:hover {
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            transform: scale(1.03);
        }

        .calc-control {
            margin: 1.5rem 0;
            animation: slideIn 0.4s ease;
        }

        .results-table {
            margin: 2rem 0;
            overflow-x: auto;
            animation: fadeIn 0.5s ease;
        }

        .results-table table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
        }

        .results-table th,
        .results-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }

        .results-table tbody tr {
            transition: all 0.3s ease;
        }

        .results-table tbody tr:hover {
            background: linear-gradient(90deg, #fef3c7, #fde68a);
            transform: scale(1.02);
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.3);
        }

        .results-table th {
            background: linear-gradient(135deg, #f9fafb, #f3f4f6);
            font-weight: 700;
            color: #374151;
        }

        .results-table .highlight-row {
            background: linear-gradient(90deg, #fef3c7, #fde68a);
            font-weight: 600;
        }

        .results-table .highlight-row:hover {
            background: linear-gradient(90deg, #fbbf24, #f59e0b);
            color: white;
            animation: jello 0.6s ease;
        }

        .warning-text {
            padding: 1rem;
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            border-left: 4px solid #ef4444;
            border-radius: 8px;
            margin-top: 1rem;
            animation: shake 0.5s ease;
        }

        .warning-text:hover {
            animation: wobble 0.6s ease infinite;
        }

        /* Extreme value celebration */
        .extreme-value {
            animation: rainbow 2s linear infinite, bounce 1s ease infinite;
            font-weight: 800;
            font-size: 1.2em;
        }

        /* Easter egg - click counter */
        .click-counter {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(229, 62, 62, 0.4);
            display: none;
            animation: bounce 0.5s ease infinite;
        }

        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            h2 { font-size: 1.75rem; }
            .plot-grid { grid-template-columns: 1fr; }
            .stat-row { grid-template-columns: 1fr; }
            .demo-controls { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="click-counter" id="clickCounter">üéâ Clicks: 0</div>

    <div class="container">
        <header>
            <h1 onclick="celebrateClick()">The Fat Tail Problem: Why Your Statistical Toolkit Might Be Lying to You üìä</h1>
            <div class="meta">
                <p><strong>Author:</strong> Dr Shalini B | <strong>Date:</strong> December 1, 2024</p>
            </div>
            <div class="tags">
                <span class="tag">probability</span>
                <span class="tag">statistics</span>
                <span class="tag">risk</span>
                <span class="tag">research</span>
                <span class="tag">fat-tails</span>
                <span class="tag">hydrology</span>
            </div>
        </header>

        <article>
            <p>I've sat through countless presentations about non-stationarity. Researchers presenting sophisticated methods: time-varying covariates, regime-switching models, adaptive parameters. Each talk more complex than the last. Yet something nagged at me.</p>

            <p>Everyone was trying to patch the same problem with increasingly complicated band-aids. What if we needed a fundamentally different kind of distribution? One that could naturally adapt its parameters over time from within, rather than being forced to do so from outside?</p>

            <p>This question led me down a rabbit hole that ended somewhere unexpected: the fat tail problem. And it turns out, this isn't just an academic curiosity. It's the reason why statistical methods fail precisely when we need them most.</p>

            <h2>The Incerto Insight üí°</h2>

            <p>Nassim Taleb's Incerto project starts with a beautiful observation:</p>

            <blockquote>
                "While there is a lot of uncertainty and opacity about the world, and an incompleteness of information and understanding, there is little, if any, uncertainty about what actions should be taken based on such an incompleteness, in any given situation."
            </blockquote>

            <p>In other words: we may not be able to predict rare events, but we can be quite certain about how to protect ourselves from them. This shift from understanding <strong>X</strong> (the random variable) to managing <strong>F(X)</strong> (our exposure to it) is revolutionary.</p>

            <h2>Two Worlds: Mediocristan vs Extremistan üåç</h2>

            <p>The key insight that changed how I think about distributions is this: not all randomness is created equal. There are fundamentally two different domains:</p>

            <h3>Mediocristan: The Land of Averages üìè</h3>

            <p>In Mediocristan:</p>
            <ul>
                <li><strong>No single observation can really change the statistics</strong> when your sample gets large</li>
                <li>If you randomly select two people with a combined height of 4.1 meters (very unlikely!), the most probable combination is 2.05m + 2.05m, not 10cm + 4m</li>
                <li><strong>The probability of two 3-sigma events is MUCH higher than one 6-sigma event</strong></li>
            </ul>

            <p>This is the world our statistical textbooks assume. The world of heights, weights, calorie consumption. The Gaussian world.</p>

            <h3>Extremistan: The Land of Black Swans ü¶¢</h3>

            <p>In Extremistan:</p>
            <ul>
                <li><strong>The tails play a disproportionately large role</strong> in determining properties</li>
                <li>If you randomly select two people with combined wealth of $36 million, the most likely combination is approximately $35,999,000 + $1,000, not $18M + $18M</li>
                <li><strong>A single extreme event is more likely than multiple moderate events that sum to the same value</strong></li>
            </ul>

            <p>This is the world of wealth, book sales, war casualties, market crashes, pandemics. The power law world.</p>

            <h3>Interactive Comparison: See the Difference ‚ú®</h3>

            <p>Let me show you this visually. Play with the sliders below and watch the magic happen!</p>

            <div id="comparison-status">‚öôÔ∏è Interactive visualization loading...</div>

            <div id="mediocristan-extremistan-compare">
                <div class="comparison-controls">
                    <h3>Mediocristan vs Extremistan: Interactive Comparison</h3>

                    <div class="control-group">
                        <label>Number of samples: <span id="n-samples-display">1000</span></label>
                        <input type="range" id="n-samples" min="100" max="10000" step="100" value="1000" oninput="updateComparison()">
                    </div>

                    <div class="control-group">
                        <label>Pareto tail parameter Œ±: <span id="alpha-display">1.5</span></label>
                        <input type="range" id="alpha-param" min="1.1" max="3.5" step="0.1" value="1.5" oninput="updateComparison()">
                        <small>Lower Œ± = fatter tails (more extreme!) üé¢</small>
                    </div>

                    <div class="stats-display" id="stats-comparison"></div>
                </div>

                <div class="plot-grid">
                    <div class="plot-item">
                        <h4>Gaussian (Mediocristan) üòå</h4>
                        <canvas id="gaussian-compare" width="400" height="300" onclick="celebrateCanvas(this)"></canvas>
                    </div>
                    <div class="plot-item">
                        <h4>Pareto (Extremistan, Œ±=<span id="alpha-display-2">1.5</span>) üî•</h4>
                        <canvas id="pareto-compare" width="400" height="300" onclick="celebrateCanvas(this)"></canvas>
                    </div>
                </div>

                <div class="insights-box">
                    <h4>üí° What to Notice:</h4>
                    <ul>
                        <li><strong>Gaussian</strong>: Most values cluster around the mean. Extreme deviations are extremely rare.</li>
                        <li><strong>Pareto</strong>: Many small values, but occasional HUGE spikes that dominate everything!</li>
                        <li><strong>Try lowering Œ±</strong>: Watch how extreme events become more common and more extreme! üé™</li>
                        <li><strong>Sample mean instability</strong>: The Pareto mean jumps around wildly - try changing the samples!</li>
                    </ul>
                </div>
            </div>

            <h2>The Catastrophe Principle ‚ö†Ô∏è</h2>

            <p><strong>Mediocristan logic:</strong> For something bad to happen, it needs to come from a series of very unlikely events, not a single one.</p>

            <p><strong>Extremistan logic:</strong> Ruin is more likely to come from a single extreme event than from a series of bad episodes. üí•</p>

            <h3>Interactive Demonstration: The Catastrophe Principle üé≠</h3>

            <div id="catastrophe-demo">
                <h3>Interactive Catastrophe Principle</h3>
                <p>Question: To reach a total deviation of 6œÉ, what's more likely?</p>

                <div class="demo-controls">
                    <div class="demo-option">
                        <input type="radio" name="disttype" id="gaussian-cat" value="gaussian" checked onchange="updateCatastrophe()">
                        <label for="gaussian-cat">Gaussian (Mediocristan) üòä</label>
                    </div>
                    <div class="demo-option">
                        <input type="radio" name="disttype" id="pareto-cat" value="pareto" onchange="updateCatastrophe()">
                        <label for="pareto-cat">Pareto Œ±=1.5 (Extremistan) üò±</label>
                    </div>
                </div>

                <div class="result-display" id="catastrophe-result"></div>

                <canvas id="catastrophe-plot" width="600" height="300"></canvas>
            </div>

            <h2>Sample Size Calculator: See For Yourself üî¢</h2>

            <div id="sample-size-calc">
                <h3>Sample Size Requirements Calculator</h3>

                <div class="calc-control">
                    <label>Desired precision (% error): <span id="precision-display">5</span>%</label>
                    <input type="range" id="precision-slider" min="1" max="20" step="1" value="5" oninput="updateSampleCalc()">
                </div>

                <div class="calc-control">
                    <label>Distribution tail parameter Œ±: <span id="alpha-calc-display">2.0</span></label>
                    <input type="range" id="alpha-calc-slider" min="1.1" max="4.0" step="0.1" value="2.0" oninput="updateSampleCalc()">
                </div>

                <div class="results-table" id="sample-calc-results"></div>

                <div class="insights-box">
                    <p><strong>Key insight:</strong> As Œ± decreases (fatter tails), the required sample size explodes exponentially! For Œ±=1.16 (the "80/20" Pareto), you need astronomically more data than for a Gaussian! üöÄ</p>
                </div>
            </div>

            <h2>My Takeaway üéØ</h2>

            <p><strong>The problem isn't that distributions are non-stationary. The problem is that we've been using the wrong class of distributions entirely.</strong></p>

            <p>Most real-world phenomena‚Äîfinancial markets, natural disasters, pandemics, conflicts, technological changes‚Äîlive in Extremistan, not Mediocristan. They're <strong>fundamentally</strong> fat-tailed.</p>

            <hr>

            <h2>References & Further Reading üìö</h2>

            <ul>
                <li>Taleb, N. N. (2020). <em>Statistical Consequences of Fat Tails</em></li>
                <li>Embrechts, P., et al. (1997). <em>Modelling Extremal Events for Insurance and Finance</em></li>
                <li>Papalexiou, S. M. & Koutsoyiannis, D. (2013). <em>Battle of extreme value distributions</em></li>
            </ul>
        </article>
    </div>

    <script>
    (function() {
        let clickCount = 0;

        // Easter egg - celebrate clicks
        window.celebrateClick = function() {
            clickCount++;
            const counter = document.getElementById('clickCounter');
            counter.textContent = `üéâ Clicks: ${clickCount}`;
            counter.style.display = 'block';

            createConfetti();

            if (clickCount >= 5) {
                document.querySelector('h1').style.background = 'linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1)';
                document.querySelector('h1').style.backgroundClip = 'text';
                document.querySelector('h1').style.webkitBackgroundClip = 'text';
                document.querySelector('h1').style.webkitTextFillColor = 'transparent';
                document.querySelector('h1').style.animation = 'rainbow 3s linear infinite';
            }

            setTimeout(() => {
                if (clickCount < 10) counter.style.display = 'none';
            }, 3000);
        };

        window.celebrateCanvas = function(canvas) {
            canvas.style.animation = 'jello 0.8s ease';
            createConfetti();
            setTimeout(() => {
                canvas.style.animation = '';
            }, 800);
        };

        function createConfetti() {
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#feca57', '#ff9ff3'];
            for (let i = 0; i < 20; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * window.innerWidth + 'px';
                confetti.style.top = '-10px';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 0.5 + 's';
                confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                document.body.appendChild(confetti);

                setTimeout(() => confetti.remove(), 5000);
            }
        }

        // Helper functions
        function gaussianRandom(mean = 0, stdev = 1) {
            const u = 1 - Math.random();
            const v = Math.random();
            const z = Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
            return z * stdev + mean;
        }

        function paretoRandom(xm = 1, alpha = 1.5) {
            const u = Math.random();
            return xm / Math.pow(u, 1/alpha);
        }

        function drawHistogram(canvasId, data, title, color = '#e53e3e') {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            const margin = 40;
            const plotWidth = width - 2 * margin;
            const plotHeight = height - 2 * margin;

            ctx.clearRect(0, 0, width, height);

            const numBins = 50;
            const maxVal = Math.max(...data);
            const minVal = Math.min(...data);
            const binWidth = (maxVal - minVal) / numBins;
            const bins = new Array(numBins).fill(0);

            data.forEach(val => {
                const binIndex = Math.min(Math.floor((val - minVal) / binWidth), numBins - 1);
                if (binIndex >= 0 && binIndex < numBins) bins[binIndex]++;
            });

            const maxBinCount = Math.max(...bins);

            // Draw axes
            ctx.strokeStyle = '#666';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(margin, height - margin);
            ctx.lineTo(width - margin, height - margin);
            ctx.moveTo(margin, margin);
            ctx.lineTo(margin, height - margin);
            ctx.stroke();

            // Draw bars with gradient
            bins.forEach((count, i) => {
                const x = margin + (i / numBins) * plotWidth;
                const barWidth = plotWidth / numBins;
                const barHeight = (count / maxBinCount) * plotHeight;
                const y = height - margin - barHeight;

                const gradient = ctx.createLinearGradient(x, y, x, height - margin);
                gradient.addColorStop(0, color);
                gradient.addColorStop(1, color + '40');

                ctx.fillStyle = gradient;
                ctx.fillRect(x, y, barWidth * 0.9, barHeight);
            });

            // Title
            ctx.fillStyle = '#333';
            ctx.font = 'bold 14px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText(title, width / 2, 20);

            // Stats
            const mean = data.reduce((a, b) => a + b, 0) / data.length;
            const sortedData = [...data].sort((a, b) => a - b);
            const median = sortedData[Math.floor(data.length / 2)];
            const p95 = sortedData[Math.floor(data.length * 0.95)];
            const max = Math.max(...data);

            ctx.font = '10px monospace';
            ctx.textAlign = 'left';
            ctx.fillStyle = '#444';
            ctx.fillText(`Mean: ${mean.toFixed(2)}`, margin + 5, margin + 15);
            ctx.fillText(`Median: ${median.toFixed(2)}`, margin + 5, margin + 30);
            ctx.fillText(`95th: ${p95.toFixed(2)}`, margin + 5, margin + 45);
            ctx.fillText(`Max: ${max.toFixed(2)}`, margin + 5, margin + 60);
        }

        function drawCatastrophePlot(distType) {
            const canvas = document.getElementById('catastrophe-plot');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            const margin = 50;

            ctx.clearRect(0, 0, width, height);

            ctx.fillStyle = '#333';
            ctx.font = 'bold 16px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Probability Comparison Visualization', width / 2, 30);

            if (distType === 'gaussian') {
                const barWidth = 80;
                const spacing = 100;
                const maxHeight = height - 100;

                const prob1 = 0.00135 * 0.00135;
                const height1 = Math.log10(1/prob1) / 25 * maxHeight;

                const gradient1 = ctx.createLinearGradient(0, height - margin - height1, 0, height - margin);
                gradient1.addColorStop(0, '#3b82f6');
                gradient1.addColorStop(1, '#60a5fa');
                ctx.fillStyle = gradient1;
                ctx.fillRect(width/2 - spacing - barWidth, height - margin - height1, barWidth, height1);

                ctx.fillStyle = '#333';
                ctx.font = '12px sans-serif';
                ctx.fillText('Two 3œÉ', width/2 - spacing - barWidth/2, height - margin + 20);
                ctx.fillText('events', width/2 - spacing - barWidth/2, height - margin + 35);

                const prob2 = 9.87e-10;
                const height2 = Math.log10(1/prob2) / 25 * maxHeight;

                const gradient2 = ctx.createLinearGradient(0, height - margin - height2, 0, height - margin);
                gradient2.addColorStop(0, '#ef4444');
                gradient2.addColorStop(1, '#fca5a5');
                ctx.fillStyle = gradient2;
                ctx.fillRect(width/2 + spacing - barWidth/2, height - margin - height2, barWidth, height2);

                ctx.fillStyle = '#333';
                ctx.fillText('One 6œÉ', width/2 + spacing, height - margin + 20);
                ctx.fillText('event', width/2 + spacing, height - margin + 35);

            } else {
                const barWidth = 80;
                const spacing = 100;
                const maxHeight = height - 100;

                const alpha = 1.5;
                const p3 = Math.pow(1/3, alpha);
                const height1 = (p3 * p3) * maxHeight * 5;

                const gradient1 = ctx.createLinearGradient(0, height - margin - height1, 0, height - margin);
                gradient1.addColorStop(0, '#3b82f6');
                gradient1.addColorStop(1, '#60a5fa');
                ctx.fillStyle = gradient1;
                ctx.fillRect(width/2 - spacing - barWidth, height - margin - height1, barWidth, height1);

                ctx.fillStyle = '#333';
                ctx.font = '12px sans-serif';
                ctx.fillText('Two 3√ó', width/2 - spacing - barWidth/2, height - margin + 20);
                ctx.fillText('events', width/2 - spacing - barWidth/2, height - margin + 35);

                const p6 = Math.pow(1/6, alpha);
                const height2 = p6 * maxHeight * 5;

                const gradient2 = ctx.createLinearGradient(0, height - margin - height2, 0, height - margin);
                gradient2.addColorStop(0, '#ef4444');
                gradient2.addColorStop(1, '#fca5a5');
                ctx.fillStyle = gradient2;
                ctx.fillRect(width/2 + spacing - barWidth/2, height - margin - height2, barWidth, height2);

                ctx.fillStyle = '#333';
                ctx.fillText('One 6√ó', width/2 + spacing, height - margin + 20);
                ctx.fillText('event', width/2 + spacing, height - margin + 35);
            }
        }

        window.updateComparison = function() {
            const nSamples = parseInt(document.getElementById('n-samples').value);
            const alpha = parseFloat(document.getElementById('alpha-param').value);

            document.getElementById('n-samples-display').textContent = nSamples;
            document.getElementById('alpha-display').textContent = alpha;
            document.getElementById('alpha-display-2').textContent = alpha;

            const gaussianData = Array.from({length: nSamples}, () => gaussianRandom(0, 1));
            const paretoData = Array.from({length: nSamples}, () => paretoRandom(1, alpha));

            drawHistogram('gaussian-compare', gaussianData, 'Gaussian Distribution', '#3b82f6');
            drawHistogram('pareto-compare', paretoData, `Pareto (Œ±=${alpha})`, '#ef4444');

            const paretoMax = Math.max(...paretoData);
            const gaussianMax = Math.max(...gaussianData);
            const gaussianMean = gaussianData.reduce((a, b) => a + b, 0) / nSamples;
            const paretoMean = paretoData.reduce((a, b) => a + b, 0) / nSamples;

            const paretoSorted = [...paretoData].sort((a,b) => b-a);
            const paretoTop1Percent = paretoData.filter(x => x > paretoSorted[Math.floor(nSamples * 0.01)]);
            const paretoTop1Sum = paretoTop1Percent.reduce((a, b) => a + b, 0);
            const paretoTotalSum = paretoData.reduce((a, b) => a + b, 0);
            const paretoTop1Contribution = (paretoTop1Sum / paretoTotalSum * 100).toFixed(1);

            const extremeClass = alpha < 1.5 ? ' extreme-value' : '';

            document.getElementById('stats-comparison').innerHTML = `
                <div class="stat-row">
                    <div class="stat-item">
                        <strong>Gaussian:</strong><br>
                        Max/Mean ratio: <span class="number-highlight">${(gaussianMax / Math.abs(gaussianMean)).toFixed(2)}</span>
                    </div>
                    <div class="stat-item">
                        <strong>Pareto:</strong><br>
                        Max/Mean ratio: <span class="number-highlight${extremeClass}">${(paretoMax / paretoMean).toFixed(2)}</span>
                    </div>
                </div>
                <div class="stat-highlight">
                    <strong>Top 1% contribution to total:</strong> <span class="${paretoTop1Contribution > 50 ? 'extreme-value' : ''}">${paretoTop1Contribution}%</span>
                    <br><small>In Extremistan, a tiny fraction contributes most of the total! ${paretoTop1Contribution > 70 ? 'üî•üî•üî•' : paretoTop1Contribution > 50 ? 'üî•' : ''}</small>
                </div>
            `;

            if (alpha < 1.3) {
                createConfetti();
            }
        };

        window.updateCatastrophe = function() {
            const distType = document.querySelector('input[name="disttype"]:checked').value;
            const resultDiv = document.getElementById('catastrophe-result');

            if (distType === 'gaussian') {
                const p3sigma = 0.00135;
                const p6sigma = 9.87e-10;
                const ratio = (p3sigma * p3sigma) / p6sigma;

                resultDiv.innerHTML = `
                    <div class="result-box mediocristan">
                        <h4>Mediocristan (Gaussian) Result: üòä</h4>
                        <p><strong>Two 3œÉ events:</strong> P(X > 3œÉ)¬≤ = ${(p3sigma * p3sigma).toExponential(3)}</p>
                        <p><strong>One 6œÉ event:</strong> P(X > 6œÉ) = ${p6sigma.toExponential(3)}</p>
                        <p class="conclusion">
                            <strong>Ratio: ${ratio.toFixed(0)}:1</strong><br>
                            Two moderate events are <strong>${ratio.toFixed(0)}√ó more likely</strong> than one extreme event! üìä
                            <br><br>
                            <em>‚Üí Bad things happen from accumulation of many unlikely events.</em>
                        </p>
                    </div>
                `;
            } else {
                const alpha = 1.5;
                const xm = 1;
                const p3 = Math.pow(xm/3, alpha);
                const p6 = Math.pow(xm/6, alpha);
                const ratio = p6 / (p3 * p3);

                resultDiv.innerHTML = `
                    <div class="result-box extremistan">
                        <h4>Extremistan (Pareto Œ±=1.5) Result: üò±</h4>
                        <p><strong>Two 3√ó events:</strong> P(X > 3)¬≤ = ${(p3 * p3).toFixed(4)}</p>
                        <p><strong>One 6√ó event:</strong> P(X > 6) = ${p6.toFixed(4)}</p>
                        <p class="conclusion">
                            <strong>Ratio: ${ratio.toFixed(2)}:1</strong><br>
                            One extreme event is <strong>${ratio.toFixed(2)}√ó more likely</strong> than two moderate events! üí•
                            <br><br>
                            <em>‚Üí Bad things happen from a SINGLE catastrophic event!</em>
                        </p>
                    </div>
                `;
                createConfetti();
            }

            drawCatastrophePlot(distType);
        };

        window.updateSampleCalc = function() {
            const precision = parseInt(document.getElementById('precision-slider').value);
            const alpha = parseFloat(document.getElementById('alpha-calc-slider').value);

            document.getElementById('precision-display').textContent = precision;
            document.getElementById('alpha-calc-display').textContent = alpha;

            const gaussianN = Math.pow(1.96 / (precision/100), 2);
            const paretoMultiplier = Math.pow(10, (3 - alpha) * 2);
            const paretoN = gaussianN * paretoMultiplier;

            const extremeClass = paretoMultiplier > 1e10 ? ' extreme-value' : '';

            const resultsHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>Distribution</th>
                            <th>Required Sample Size</th>
                            <th>Relative to Gaussian</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Gaussian (thin-tailed) üòå</td>
                            <td>${Math.round(gaussianN).toLocaleString()}</td>
                            <td>1√ó</td>
                        </tr>
                        <tr class="highlight-row">
                            <td>Pareto (Œ± = ${alpha}) ${alpha < 1.5 ? 'üî•' : ''}</td>
                            <td class="${extremeClass}">${paretoN > 1e9 ? paretoN.toExponential(2) : Math.round(paretoN).toLocaleString()}</td>
                            <td><strong class="${extremeClass}">${paretoMultiplier.toExponential(1)}√ó</strong></td>
                        </tr>
                    </tbody>
                </table>
                <p class="warning-text">
                    ${alpha < 1.5 ? '‚ö†Ô∏è <strong>Warning:</strong> This is astronomically large! Practical estimation may be IMPOSSIBLE! üö®' :
                      alpha < 2.0 ? '‚ö†Ô∏è Sample size is very large - convergence will be slow. ‚è∞' :
                      'Sample size is manageable but still much larger than Gaussian. ‚úÖ'}
                </p>
            `;

            document.getElementById('sample-calc-results').innerHTML = resultsHTML;

            if (paretoMultiplier > 1e10) {
                createConfetti();
            }
        };

        function initialize() {
            const statusDiv = document.getElementById('comparison-status');
            if (!statusDiv) {
                setTimeout(initialize, 100);
                return;
            }

            try {
                updateComparison();
                updateCatastrophe();
                updateSampleCalc();

                statusDiv.innerHTML = '‚úÖ Interactive visualizations ready! Adjust the parameters and have fun exploring! üéâ';
                statusDiv.style.background = '#d1fae5';
                statusDiv.style.borderColor = '#10b981';
                statusDiv.style.color = '#065f46';
                statusDiv.style.animation = 'none';

                // Welcome confetti
                setTimeout(createConfetti, 500);
            } catch (error) {
                console.error('Initialization error:', error);
                statusDiv.innerHTML = '‚ùå Error loading visualizations: ' + error.message;
                statusDiv.style.background = '#fee2e2';
                statusDiv.style.borderColor = '#ef4444';
                statusDiv.style.color = '#991b1b';
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initialize);
        } else {
            initialize();
        }
    })();
    </script>
</body>
</html>
